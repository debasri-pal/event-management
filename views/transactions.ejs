<!DOCTYPE html>
<html>
<head>
  <title>Transactions</title>
  <link rel="stylesheet" href="/style.css">
</head>
<body>

<div class="navbar">
  Event Management - Admin Panel
</div>

<div class="dashboard">

<div class="sidebar">

  <% if (user.role === "admin") { %>
    <h3>Admin Panel</h3>
    <a href="/dashboard">Dashboard</a>
    <a href="/maintenance">Maintenance</a>
    <a href="/reports">Reports</a>
    <a href="/transactions">Transactions</a>
    <a href="/logout">Logout</a>
  <% } else { %>
    <h3>User Panel</h3>
    <a href="/dashboard">Dashboard</a>
    <a href="/makePayment">Make Payment</a>
    <a href="/transactions">My Transactions</a>
    <a href="/logout">Logout</a>
  <% } %>

</div>


  <div class="main">
<div class="card">
  <h2>
    <% if (user.role === "admin") { %>
      All Transactions ðŸ’³
    <% } else { %>
      My Transactions ðŸ’³
    <% } %>
  </h2>
  <!-- ðŸ” SEARCH + FILTER FORM -->
  <form method="GET" action="/transactions" style="margin-bottom:20px;">
<input type="text" name="search" placeholder="Search by email"
value="<%= request.query.search || '' %>">

<input type="date" name="startDate"
value="<%= request.query.startDate || '' %>">

<input type="date" name="endDate"
value="<%= request.query.endDate || '' %>">


    <button type="submit">Apply</button>
  </form>

  <table class="transaction-table">
    <thead>
      <tr>
        <% if (user.role === "admin") { %>
          <th>User Email</th>
        <% } %>
        
        <th>Amount (â‚¹)</th>
        <th>Status</th>
        <th>Date</th>

      </tr>
    </thead>

    <tbody>
      <% transactions.forEach(t => { %>
        <tr>
          <% if (user.role === "admin") { %>
            <td><%= t.userEmail %></td>
          <% } %>
<td>â‚¹<%= t.amount %></td>

<td>
  <span class="badge <%= t.status.replace(/\s/g, '') %>">
    <%= t.status %>
  </span>
</td>

<td><%= new Date(t.createdAt).toDateString() %></td>

        </tr>
      <% }) %>
    </tbody>
  </table>
  <!-- ðŸ“„ PAGINATION -->
<div class="pagination" style="margin-top:20px;">
  <% for(let i = 1; i <= totalPages; i++) { %>
<a href="/transactions?page=<%= i %>&search=<%= request.query.search || '' %>&startDate=<%= request.query.startDate || '' %>&endDate=<%= request.query.endDate || '' %>">
  <%= i %>
</a>

  <% } %>
</div>

</div>


</div>

</body>
</html>
